---
title: "EDA"
output: pdf_document
date: "2023-04-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggplot2)
library(GGally)
```

```{r}
data_EDA <- read.csv(file='./data/listings_EDA.csv')
data_clean <- read.csv(file='./data/listings_clean.csv')

```

```{r}
# check correlation
GGally::ggcorr(data_clean, method = c("pairwise.complete.obs", "pearson"),
  digits = 1, 
  low = '#800080', mid = '#FFC0CB', high = '#FFF8DC', 
  label = TRUE, label_size = 2, label_color = "black",
  size = 2, hjust = 1, layout.exp = 3) +
  ggtitle("Correlation")
```

```{r}
colors <- c('#800080','#DDA0DD', '#FF9282', '#FFC0CB', '#FFF8DC')
ggplot(data=data_EDA, aes(x=neighbourhood_group_cleansed, y=price, fill=neighbourhood_group_cleansed)) +
  geom_boxplot() +
  scale_y_log10() +
  theme_bw()+
  scale_fill_manual(values = colors, name="")+
  xlab("neighborhood") +
  ylab("price (log scale)") +
  ggtitle("NYC Airbnb price for different neighborhoods")
```
```{r}
ggplot(data=data_EDA,aes(price))+
  geom_histogram(bins=30, fill='#FF9282',color='#e9ecef')+
  theme_bw()+scale_x_log10()+
  labs(x='price (log scale)',y='count',title='NYC Airbnb price distribution')
```
```{r}
library(ggmap)
library(sp)
library(mapview)
library(RColorBrewer)
map_EDA=data.frame(price_level=cut(data_EDA$price_log, breaks=c(-Inf, 0.25*max(data_EDA$price_log), 0.5*max(data_EDA$price_log), 0.75*max(data_EDA$price_log), Inf), labels = c(1,2,3,4), right=FALSE))
map_EDA$longitude = data_EDA$longitude
map_EDA$latitude = data_EDA$latitude

map_view=map_EDA
coordinates(map_view)=~longitude+latitude
proj4string(map_view)=CRS('+init=epsg:4326')
pal = colorRampPalette(brewer.pal(9, "YlOrRd"))
mapview(map_view,zcol='price_level', cex=2, alpha=0.5, col.regions=pal, color=NA)
```

